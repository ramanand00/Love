<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Love ‚ù§Ô∏è</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
  <style>
    .heart {
      position: absolute;
      font-size: 2rem;
      animation: float 2s ease-out forwards;
      color: pink;
    }

    @keyframes float {
      0% { opacity: 1; transform: translateY(0) scale(1); }
      100% { opacity: 0; transform: translateY(-100px) scale(0.5); }
    }

    .confetti {
      position: fixed;
      width: 10px;
      height: 10px;
      background: pink;
      top: 0;
      left: 50%;
      animation: fall 1s ease-in forwards;
    }

    @keyframes fall {
      0% { transform: translateY(0) rotate(0deg); }
      100% { transform: translateY(300px) rotate(360deg); opacity: 0; }
    }
  </style>
</head>
<body class="bg-gradient-to-r from-pink-200 via-red-200 to-pink-300 min-h-screen flex items-center justify-center p-6 relative overflow-hidden">

  <div id="main-container" class="w-full max-w-lg bg-white shadow-2xl rounded-2xl p-8 text-center">
    <!-- Registration for User A -->
    <div id="registerA">
      <h1 class="text-3xl font-bold text-pink-600 mb-4">Welcome to Love ‚ù§Ô∏è</h1>
      <p class="mb-6 text-gray-600">Create your account and get your special love link.</p>

      <form id="formA" class="space-y-4">
        <input type="text" id="nameA" placeholder="Your Name" class="w-full p-3 border rounded-xl focus:ring-2 focus:ring-pink-400" required>
        <input type="email" id="emailA" placeholder="Your Email" class="w-full p-3 border rounded-xl focus:ring-2 focus:ring-pink-400" required>
        <input type="password" id="passA" placeholder="Password" class="w-full p-3 border rounded-xl focus:ring-2 focus:ring-pink-400" required>
        <button type="submit" class="w-full bg-pink-500 hover:bg-pink-600 text-white py-3 rounded-xl shadow-lg transition">
          Get My Link
        </button>
      </form>
    </div>

    <!-- Show Link -->
    <div id="linkSection" class="hidden">
      <h2 class="text-xl font-semibold text-gray-700 mb-4">Your Special Link üíå</h2>
      <p class="text-gray-600">Share this link with your loved one:</p>
      <input type="text" id="shareLink" readonly class="w-full p-3 border rounded-xl text-center mt-3">
      <button onclick="copyLink()" class="mt-4 bg-red-400 hover:bg-red-500 text-white py-2 px-6 rounded-xl">
        Copy Link
      </button>
    </div>

    <!-- Registration for User B -->
    <div id="registerB" class="hidden">
      <h2 class="text-2xl font-bold text-pink-600 mb-4">Someone Sent You Love üíñ</h2>
      <p class="mb-6 text-gray-600">Fill the form to unlock your love letter.</p>
      <form id="formB" class="space-y-4">
        <input type="text" id="nameB" placeholder="Your Name" class="w-full p-3 border rounded-xl focus:ring-2 focus:ring-pink-400" required>
        <input type="email" id="emailB" placeholder="Your Email" class="w-full p-3 border rounded-xl focus:ring-2 focus:ring-pink-400" required>
        <input type="text" id="mobileB" placeholder="Your Mobile Number" class="w-full p-3 border rounded-xl focus:ring-2 focus:ring-pink-400" required>
        <input type="password" id="passB" placeholder="Password" class="w-full p-3 border rounded-xl focus:ring-2 focus:ring-pink-400" required>
        <button type="submit" class="w-full bg-pink-500 hover:bg-pink-600 text-white py-3 rounded-xl shadow-lg transition">
          Unlock Love Letter
        </button>
      </form>
    </div>

    <!-- Love Letter -->
    <div id="loveLetter" class="hidden">
      <h2 class="text-3xl font-bold text-red-500 mb-6">üíå Love Letter</h2>
      <p class="text-lg text-gray-700 leading-relaxed text-left">
        My dearest <span id="bNameText" class="font-semibold text-pink-600"></span>,  
        <br><br>
        From the moment I saw you, I knew you were the one who would make my heart skip a beat.  
        Every smile of yours feels like sunshine after the rain, and every word you say feels like poetry to me.  
        Life is beautiful because you are in it.  
        <br><br>
        No matter where life takes us, know that my heart will always belong to you.  
        You are not just my love‚Äîyou are my everything.  
        <br><br>
        Forever yours,  
      </p>
    <p id="senderName" class="mt-6 text-xl font-bold text-pink-600 text-right"></p>
      <div class="flex flex-col md:flex-row gap-2 justify-center mt-4">
        <button onclick="downloadLetter()" class="bg-pink-500 hover:bg-pink-600 text-white py-2 px-6 rounded-xl">Save Love Letter</button>
        <button onclick="shareWhatsApp()" class="bg-green-500 hover:bg-green-600 text-white py-2 px-6 rounded-xl">Share on WhatsApp</button>
      </div>
      <div class="mt-6">
        <h3 class="text-lg font-semibold text-pink-600 mb-2">Send a Reply üí¨</h3>
        <textarea id="replyMsg" rows="3" class="w-full p-2 border rounded-xl mb-2" placeholder="Write your reply..."></textarea>
        <button onclick="sendReply()" class="bg-red-400 hover:bg-red-500 text-white py-2 px-6 rounded-xl">Send Reply</button>
        <div id="replyStatus" class="mt-2 text-green-600 font-semibold"></div>
    <p id="loveText" class="text-lg text-gray-700 dark:text-gray-200 leading-relaxed text-left min-h-[180px]"></p>
      </div>
    </div>
  </div>

  <!-- Sweet Audio -->
  <audio id="loveAudio" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"></audio>

  <script>
    const params = new URLSearchParams(window.location.search);
    const senderName = params.get("from");

    const registerA = document.getElementById("registerA");
    const linkSection = document.getElementById("linkSection");
    const registerB = document.getElementById("registerB");
    const loveLetter = document.getElementById("loveLetter");

    const formA = document.getElementById("formA");
    const formB = document.getElementById("formB");

    const shareLink = document.getElementById("shareLink");
    const senderText = document.getElementById("senderName");
    const bNameText = document.getElementById("bNameText");

    const loveAudio = document.getElementById("loveAudio");

    if (senderName) {
      registerA.classList.add("hidden");
      registerB.classList.remove("hidden");
    }

    // Countdown timer for link (5 minutes)
    let countdownInterval;
    function startCountdown() {
      let seconds = 300;
      const linkSection = document.getElementById("linkSection");
      let timerDiv = document.getElementById("timerDiv");
      if (!timerDiv) {
        timerDiv = document.createElement("div");
        timerDiv.id = "timerDiv";
        timerDiv.className = "mt-2 text-sm text-gray-500";
        linkSection.appendChild(timerDiv);
      }
      timerDiv.textContent = `Link expires in ${Math.floor(seconds/60)}:${(seconds%60).toString().padStart(2,"0")}`;
      countdownInterval = setInterval(() => {
        seconds--;
        timerDiv.textContent = `Link expires in ${Math.floor(seconds/60)}:${(seconds%60).toString().padStart(2,"0")}`;
        if (seconds <= 0) {
          clearInterval(countdownInterval);
          timerDiv.textContent = "Link expired! Please generate again.";
          shareLink.value = "";
        }
      }, 1000);
    }

    formA.addEventListener("submit", (e) => {
      e.preventDefault();
      const nameA = document.getElementById("nameA").value;
      const link = `${window.location.href.split("?")[0]}?from=${encodeURIComponent(nameA)}`;
      shareLink.value = link;
      registerA.classList.add("hidden");
      linkSection.classList.remove("hidden");
      showHeart();
      startCountdown();
    });
    // WhatsApp sharing
    function shareWhatsApp() {
      const msg = `Someone sent you a love letter! Open this link: ${window.location.href}`;
      const url = `https://wa.me/?text=${encodeURIComponent(msg)}`;
      window.open(url, "_blank");
    }

    // Reply feature
    function sendReply() {
      const reply = document.getElementById("replyMsg").value;
      const status = document.getElementById("replyStatus");
      if (!reply.trim()) {
        status.textContent = "Please write a reply.";
        status.className = "mt-2 text-red-600 font-semibold";
        return;
      }
      status.textContent = "Reply sent! (Simulated)";
      status.className = "mt-2 text-green-600 font-semibold";
      setTimeout(() => { status.textContent = ""; }, 3000);
    }

    formB.addEventListener("submit", (e) => {
      e.preventDefault();
      const nameB = document.getElementById("nameB").value;
      bNameText.textContent = nameB;
      senderText.textContent = senderName;
      registerB.classList.add("hidden");
      loveLetter.classList.remove("hidden");
      loveAudio.play();
      launchConfetti();
        // Animated typing effect for love letter
        typeLoveLetter(nameB);
    });

      // Animated typing effect for love letter
      function typeLoveLetter(nameB) {
        const text = `My dearest ${nameB},\n\nFrom the moment I saw you, I knew you were the one who would make my heart skip a beat.\nEvery smile of yours feels like sunshine after the rain, and every word you say feels like poetry to me.\nLife is beautiful because you are in it.\n\nNo matter where life takes us, know that my heart will always belong to you.\nYou are not just my love‚Äîyou are my everything.\n\nForever yours,`;
        const loveText = document.getElementById("loveText");
        loveText.textContent = "";
        let i = 0;
        function type() {
          if (i < text.length) {
            loveText.textContent += text[i] === "\n" ? "\n" : text[i];
            i++;
            setTimeout(type, text[i-1] === "\n" ? 200 : 35);
          }
        }
        type();
      }

      // Emoji picker for reply
      const emojis = ["üòç","ü•∞","üòò","üíñ","üíã","üíï","üíì","üíû","üíù","üíó","üíò","‚ù§Ô∏è","ü´∂","üíê","üåπ","üòª","üòö","üòô","üòΩ","ü§ó","üòá"];
      function toggleEmojiPicker() {
        const picker = document.getElementById("emojiPicker");
        picker.innerHTML = "";
        if (picker.classList.contains("hidden")) {
          emojis.forEach(e => {
            const btn = document.createElement("button");
            btn.textContent = e;
            btn.className = "px-2 py-1 text-xl hover:bg-pink-100 rounded";
            btn.onclick = () => {
              document.getElementById("replyMsg").value += e;
            };
            picker.appendChild(btn);
          });
          picker.classList.remove("hidden");
        } else {
          picker.classList.add("hidden");
        }
      }

      // Random love quote feature
      const quotes = [
        "Love is composed of a single soul inhabiting two bodies. ‚Äì Aristotle",
        "You are my heart, my life, my one and only thought. ‚Äì Arthur Conan Doyle",
        "I love you not only for what you are, but for what I am when I am with you. ‚Äì Roy Croft",
        "If I know what love is, it is because of you. ‚Äì Hermann Hesse",
        "You are the finest, loveliest, tenderest, and most beautiful person I have ever known. ‚Äì F. Scott Fitzgerald",
        "I would rather spend one lifetime with you than face all the ages of this world alone. ‚Äì J.R.R. Tolkien",
        "I look at you and see the rest of my life in front of my eyes.",
        "You are my today and all of my tomorrows. ‚Äì Leo Christopher",
        "I love you more than I have ever found a way to say to you. ‚Äì Ben Folds",
        "You are the best thing that‚Äôs ever been mine. ‚Äì Taylor Swift"
      ];
      function showQuote() {
        const quoteBox = document.getElementById("quoteBox");
        quoteBox.textContent = quotes[Math.floor(Math.random()*quotes.length)];
      }
    function copyLink() {
      shareLink.select();
      document.execCommand("copy");
      alert("Link copied to clipboard!");
    }

    // Heart animation
    function showHeart() {
      const heart = document.createElement("div");
      heart.className = "heart";
      heart.style.left = Math.random() * window.innerWidth + "px";
      heart.textContent = "‚ù§Ô∏è";
      document.body.appendChild(heart);
      setTimeout(() => heart.remove(), 2000);
    }

    // Confetti animation
    function launchConfetti() {
      for(let i=0; i<50; i++){
        const conf = document.createElement("div");
        conf.className = "confetti";
        conf.style.left = Math.random()*window.innerWidth + "px";
        conf.style.background = `hsl(${Math.random()*360}, 70%, 70%)`;
        document.body.appendChild(conf);
        setTimeout(() => conf.remove(), 1500);
      }
    }

    // Download love letter
    function downloadLetter() {
      html2canvas(loveLetter).then(canvas => {
        const link = document.createElement("a");
        link.download = "LoveLetter.png";
        link.href = canvas.toDataURL();
        link.click();
      });
    }
  </script>
</body>
</html>
